"use strict";(self.webpackChunkclients=self.webpackChunkclients||[]).push([[394],{5394:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var n=a(4165),r=a(5861),p=a(1413),o=a(9439),l=a(2791),s=a(7689),i=a(8446),u=a(8914),c=a(8992),d=a(4758),v=a(6817),f=a(6151),h=a(3658),Z=a(9201),m=a(184),x=(0,Z.Z)((0,m.jsx)("path",{d:"m6 2 .01 6L10 12l-3.99 4.01L6 22h12v-6l-4-4 4-3.99V2H6zm10 14.5V20H8v-3.5l4-4 4 4z"}),"HourglassTop"),g=(0,Z.Z)((0,m.jsx)("path",{d:"M22 5.18 10.59 16.6l-4.24-4.24 1.41-1.41 2.83 2.83 10-10L22 5.18zm-2.21 5.04c.13.57.21 1.17.21 1.78 0 4.42-3.58 8-8 8s-8-3.58-8-8 3.58-8 8-8c1.58 0 3.04.46 4.28 1.25l1.44-1.44C16.1 2.67 14.13 2 12 2 6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10c0-1.19-.22-2.33-.6-3.39l-1.61 1.61z"}),"TaskAlt"),S=a(148),j="DeptSelectUI_uiSection__HwKGJ",y="DeptSelectUI_container__C-M6l",N="DeptSelectUI_heading__i5Px5",_="DeptSelectUI_btnContainer__icghp",k=function(e){var t=e.loadingApproval,a=e.loadingSend,n=e.deptNames,r=e.showAppprovalBtns,p=e.handleApprovalClick,o=e.showSendBtn,l=e.sendBtnText,s=e.handleSendBtn,i=e.handleDeptBtnClick,u=e.deptStatus,c=e.approval;return(0,m.jsxs)("section",{className:j,children:[(0,m.jsxs)("div",{className:y,children:[(0,m.jsx)("h1",{className:N,children:"Select Department"}),(0,m.jsx)("div",{children:n&&n.map((function(e,a){return(0,m.jsxs)("div",{className:_,children:[(0,m.jsx)(f.Z,{onClick:function(t){return i(t,e)},sx:{width:"8rem"},variant:"outlined",color:u&&u[e]?"success":"secondary",endIcon:u&&u[e]?(0,m.jsx)(h.Z,{}):null,children:e}),r&&r(e)?(0,m.jsx)(f.Z,{variant:"outlined",sx:{marginLeft:"1.2rem",width:"9rem"},endIcon:t&&t(e)?(0,m.jsx)(x,{}):c[e]?(0,m.jsx)(g,{}):(0,m.jsx)(S.Z,{}),disabled:!!c[e],onClick:function(t){return p(t,e)},children:c[e]?"Approved":"Approve"}):""]},a)}))})]}),o&&(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[l&&(0,m.jsx)("h1",{style:{padding:"1.5rem"},children:l}),(0,m.jsx)(f.Z,{variant:"contained",sx:{width:"9rem"},endIcon:a?(0,m.jsx)(x,{}):(0,m.jsx)(S.Z,{}),onClick:s,children:"Send"})]})]})},w=function(e){var t=e.deptNames,a=e.deptStatus,u=e.user,c=e.approval1,d=e.approval2,f=e.fetchApproval2,h=(e.fetchDeptNames,e.fetchDeptStatus,e.fetchApproval1),Z=(0,s.s0)(),x=(0,l.useState)({send:!1,approval1:{},approval2:{}}),g=(0,o.Z)(x,2),S=g[0],j=g[1],y=function(e,t){e.preventDefault(),Z("/table/".concat(t))};return(0,v.u)(u.designation)&&1===u.phase?(0,m.jsx)(k,{deptNames:t,handleDeptBtnClick:y,loadingSend:S.send,showSendBtn:(0,v.u)(u.designation)&&1===u.phase,sendBtnText:"Done Filling Data ?",handleSendBtn:function(e){e.preventDefault(),S.send||(j((function(e){return e.send=!0,{send:e.send,approval1:(0,p.Z)({},e.approval1),approval2:(0,p.Z)({},e.approval2)}})),fetch("".concat(i.p,"/api/explore/phase1end"),{method:"POST",credentials:"include"}).then(function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return",t.json());case 2:return e.next=4,t.json();case 4:return a=e.sent,e.next=7,Promise.reject(a);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){alert(e),window.location.reload()})).catch((function(e){alert(JSON.stringify(e))})).finally((function(){j((function(e){return e.send=!0,{send:e.send,approval1:(0,p.Z)({},e.approval1),approval2:(0,p.Z)({},e.approval2)}}))})))}}):!(0,v.u)(u.designation)||2!==u.phase&&3!==u.phase?(0,v.wU)(u.designation)&&4===u.phase?(0,m.jsx)(k,{loadingApproval:function(e){return S.approval2[e]},deptNames:t,deptStatus:a,showAppprovalBtns:function(e){return c&&c[e]&&d},handleApprovalClick:function(e,t){e.preventDefault(),S.approval2[t]||(j((function(e){return e.approval2[t]=!0,{send:e.send,approval1:(0,p.Z)({},e.approval1),approval2:(0,p.Z)({},e.approval2)}})),fetch("".concat(i.p,"/api/explore/approval2?deptName=").concat(t),{method:"PUT",credentials:"include"}).then(function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return",t.json());case 2:return e.next=4,t.json();case 4:return a=e.sent,e.next=7,Promise.reject(a);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){alert(e),f()})).catch((function(e){alert(JSON.stringify(e))})).finally((function(){j((function(e){return e.approval2[t]=!1,{send:e.send,approval1:(0,p.Z)({},e.approval1),approval2:(0,p.Z)({},e.approval2)}}))})))},handleDeptBtnClick:y,approval:d}):(0,m.jsx)("div",{children:"You are not Authorized to view this page !"}):(0,m.jsx)(k,{loadingApproval:function(e){return S.approval1[e]},deptNames:t,deptStatus:a,showAppprovalBtns:function(e){return a&&a[e]&&c},handleApprovalClick:function(e,t){e.preventDefault(),S.approval1[t]||(j((function(e){return e.approval1[t]=!0,{send:e.send,approval1:(0,p.Z)({},e.approval1),approval2:(0,p.Z)({},e.approval2)}})),fetch("".concat(i.p,"/api/explore/approval1?deptName=").concat(t),{method:"PUT",credentials:"include"}).then(function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return",t.json());case 2:return e.next=4,t.json();case 4:return a=e.sent,e.next=7,Promise.reject(a);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){alert(e),h()})).catch((function(e){alert(JSON.stringify(e))})).finally((function(){j((function(e){return e.approval1[t]=!1,{send:e.send,approval1:(0,p.Z)({},e.approval1),approval2:(0,p.Z)({},e.approval2)}}))})))},handleDeptBtnClick:y,approval:c})},D=function(e,t){switch(t.type){case"deptNames-data":return(0,p.Z)((0,p.Z)({},e),{},{deptNames:t.data});case"deptStatus-data":return(0,p.Z)((0,p.Z)({},e),{},{deptStatus:t.data});case"approval1-data":return(0,p.Z)((0,p.Z)({},e),{},{approval1:t.data});case"approval2-data":return(0,p.Z)((0,p.Z)({},e),{},{approval2:t.data});case"deptNames-loading-false":return(0,p.Z)((0,p.Z)({},e),{},{loading_deptNames:!1});case"deptStatus-loading-false":return(0,p.Z)((0,p.Z)({},e),{},{loading_deptStatus:!1});case"approval1-loading-false":return(0,p.Z)((0,p.Z)({},e),{},{loading_approval1:!1});case"approval2-loading-false":return(0,p.Z)((0,p.Z)({},e),{},{loading_approval2:!1});case"deptNames-loading-true":return(0,p.Z)((0,p.Z)({},e),{},{loading_deptNames:!0});case"deptStatus-loading-true":return(0,p.Z)((0,p.Z)({},e),{},{loading_deptStatus:!0});case"approval1-loading-true":return(0,p.Z)((0,p.Z)({},e),{},{loading_approval1:!0});case"approval2-loading-true":return(0,p.Z)((0,p.Z)({},e),{},{loading_approval2:!0});case"error":return(0,p.Z)((0,p.Z)({},e),{},{error:t.data});default:return(0,p.Z)({},e)}},A={deptNames:void 0,deptStatus:void 0,approval1:void 0,approval2:void 0,loading_deptNames:!1,loading_deptStatus:!1,loading_approval1:!1,loading_approval2:!1,error:void 0},C=function(){var e=(0,l.useContext)(d.Z).user,t=(0,l.useReducer)(D,A),a=(0,o.Z)(t,2),n=a[0],r=a[1],p=function(){return(0,u.i)("".concat(i.p,"/api/explore/deptNames"),{method:"GET"},(function(){return r({type:"deptNames-loading-true"})}),(function(e){return r({type:"deptNames-data",data:e})}),(function(e){return r({type:"error",data:e})}),(function(){return r({type:"deptNames-loading-false"})}))};(0,l.useEffect)((function(){return p()}),[e.phase]);var s=function(){return(0,u.i)("".concat(i.p,"/api/explore/allDeptStatus"),{method:"GET"},(function(){return r({type:"deptStatus-loading-true"})}),(function(e){return r({type:"deptStatus-data",data:e})}),(function(e){return r({type:"error",data:e})}),(function(){return r({type:"deptStatus-loading-false"})}))};(0,l.useEffect)((function(){if(e.phase&&4!==e.phase&&1!==e.phase)return s()}),[e.phase]);var v=function(){return(0,u.i)("".concat(i.p,"/api/explore/allApproval1"),{method:"GET"},(function(){return r({type:"approval1-loading-true"})}),(function(e){return r({type:"approval1-data",data:e})}),(function(e){return r({type:"error",data:e})}),(function(){return r({type:"approval1-loading-false"})}))};(0,l.useEffect)((function(){if(e.phase&&1!==e.phase)return v()}),[e.phase]);var f=function(){return(0,u.i)("".concat(i.p,"/api/explore/allApproval2"),{method:"GET"},(function(){return r({type:"approval2-loading-true"})}),(function(e){return r({type:"approval2-data",data:e})}),(function(e){return r({type:"error",data:e})}),(function(){return r({type:"approval2-loading-false"})}))};return(0,l.useEffect)((function(){if(e.phase&&4===e.phase)return f()}),[e.phase]),(0,m.jsx)("div",{children:n.loading_deptNames||n.loading_deptStatus||n.loading_approval2||n.loading_approval2?(0,m.jsx)(c.Z,{}):n.error?(0,m.jsx)("div",{children:JSON.stringify(n.error)}):(0,m.jsx)(w,{user:e,deptNames:n.deptNames,deptStatus:n.deptStatus,approval1:n.approval1,approval2:n.approval2,fetchDeptNames:p,fetchDeptStatus:s,fetchApproval1:v,fetchApproval2:f})})}}}]);
//# sourceMappingURL=394.f4eead25.chunk.js.map